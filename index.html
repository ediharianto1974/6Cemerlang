<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPK6C PRO - 6 CEMERLANG</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --n-blue: #00f3ff;
            --n-pink: #ff0055;
            --n-green: #39ff14;
            --n-yellow: #fff200;
            --bg-dark: #050508;
            --glass: rgba(0, 0, 0, 0.85);
            --card-bg: rgba(10, 10, 15, 0.95);
            --border-glow: 0 0 15px rgba(0, 243, 255, 0.4);
        }

        /* 1. ASAS & LAYOUT */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            text-transform: uppercase;
        }

        body {
            background: var(--bg-dark);
            /* Anda boleh letakkan space.gif jika ada, jika tidak ia akan jadi hitam elegan */
            background-image: radial-gradient(circle at center, #0a0a1a 0%, #000 100%);
            color: #fff;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            font-family: 'Roboto Condensed', sans-serif;
            display: flex;
        }

        /* 2. ANIMASI NEON */
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 5px var(--n-green); border-color: var(--n-green); }
            50% { box-shadow: 0 0 20px var(--n-green); border-color: #fff; }
            100% { box-shadow: 0 0 5px var(--n-green); border-color: var(--n-green); }
        }

        /* 3. SISTEM NAVIGASI (VIEWPORT) */
        .viewport {
            display: flex;
            width: 300vw;
            height: 100vh;
            transition: transform 0.7s cubic-bezier(0.19, 1, 0.22, 1);
        }

        .slide {
            width: 100vw;
            height: 100vh;
            padding: 10px 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }

        .nav-btn {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.8);
            border: 2px solid var(--n-blue);
            color: var(--n-blue);
            width: 50px;
            height: 100px;
            cursor: pointer;
            z-index: 5000;
            border-radius: 15px;
            font-size: 1.8rem;
            transition: 0.3s;
            backdrop-filter: blur(5px);
        }
        .nav-btn:hover { background: var(--n-blue); color: #000; box-shadow: 0 0 25px var(--n-blue); }
        .btn-prev { left: 15px; }
        .btn-next { right: 15px; }

        /* 4. HEADER & CLOCK */
        .header-panel {
            text-align: center;
            margin-bottom: 10px;
            background: var(--glass);
            padding: 10px 40px;
            border-radius: 0 0 20px 20px;
            border: 2px solid var(--n-blue);
            border-top: none;
            box-shadow: var(--border-glow);
        }

        .header-panel h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.4rem;
            color: var(--n-blue);
            letter-spacing: 3px;
        }

        .digital-clock {
            position: fixed;
            top: 15px;
            right: 80px;
            font-family: 'Orbitron', sans-serif;
            color: var(--n-blue);
            font-size: 1.2rem;
            background: rgba(0,0,0,0.6);
            padding: 5px 15px;
            border-radius: 8px;
            border: 1px solid var(--n-blue);
            z-index: 4000;
        }

        /* 5. KONTENA DATA */
        .main-container {
            width: 100%;
            flex-grow: 1;
            background: var(--card-bg);
            border-radius: 20px;
            border: 1px solid rgba(0, 243, 255, 0.2);
            padding: 20px;
            overflow-y: auto;
            scrollbar-width: none;
        }
        .main-container::-webkit-scrollbar { display: none; }

        /* 6. SLIDE 1: STRUKTUR (DIPERBAIKI CENTERING) */
        .org-wrapper {
            max-width: 1000px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .org-row {
            display: grid;
            grid-template-columns: 180px 1fr;
            align-items: center;
            gap: 20px;
            background: rgba(255,255,255,0.03);
            padding: 10px 20px;
            border-radius: 10px;
            border-left: 5px solid var(--n-blue);
        }
        .org-label {
            color: var(--n-blue);
            font-weight: 800;
            font-size: 0.8rem;
        }
        .input-group {
            display: flex;
            gap: 10px;
            justify-content: center; /* KANDUNGAN DI TENGAH */
            width: 100%;
        }
        .ajk-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            width: 100%;
            place-items: center; /* KANDUNGAN DI TENGAH */
        }
        .st-in {
            background: rgba(0,0,0,0.5);
            border: 1px solid rgba(0,243,255,0.3);
            border-radius: 5px;
            color: var(--n-green);
            padding: 10px;
            font-size: 0.9rem;
            width: 100%;
            text-align: center; /* TULISAN DI TENGAH */
            outline: none;
        }

        /* 7. SLIDE 2: JADUAL (RESPONSIVE TABLE) */
        .table-scroll {
            width: 100%;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 4px;
            min-width: 900px; /* Supaya tak hancur di mobile */
        }
        th {
            background: rgba(0, 243, 255, 0.15);
            color: var(--n-blue);
            font-size: 0.7rem;
            padding: 10px;
            border: 1px solid var(--n-blue);
            font-family: 'Orbitron', sans-serif;
        }
        td {
            background: rgba(255,255,255,0.02);
            height: 70px;
            border: 1px solid rgba(255,255,255,0.05);
            transition: 0.3s;
        }
        .slot-active {
            animation: pulse-glow 2s infinite ease-in-out;
            background: rgba(57, 255, 20, 0.1) !important;
            border: 2px solid var(--n-green) !important;
        }
        .tt-in-sub {
            width: 100%;
            background: transparent;
            border: none;
            color: var(--n-green);
            font-weight: 900;
            font-size: 1rem;
            text-align: center;
            outline: none;
        }
        .tt-in-guru {
            width: 100%;
            background: transparent;
            border: none;
            color: #aaa;
            font-size: 0.6rem;
            text-align: center;
            outline: none;
        }
        .rehat-cell {
            background: rgba(255, 0, 85, 0.2) !important;
            color: var(--n-pink);
            font-weight: 900;
            text-align: center;
            font-size: 1.5rem;
            border: 1px solid var(--n-pink) !important;
        }

        /* 8. SLIDE 3: BERTUGAS (NEON CARDS) */
        .duty-wrapper {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
        }
        .duty-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(0,243,255,0.2);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
        }
        .duty-title {
            color: var(--n-blue);
            font-weight: 900;
            border-bottom: 1px solid var(--n-blue);
            margin-bottom: 10px;
            padding-bottom: 5px;
        }
        .task-box { margin-bottom: 12px; }
        .task-label { font-size: 0.7rem; color: var(--n-yellow); font-weight: bold; display: block; margin-bottom: 4px; }
        .dt-in {
            background: rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
            color: white;
            border-radius: 5px;
            padding: 6px;
            width: 100%;
            text-align: center;
            resize: none;
            outline: none;
        }

        /* 9. BUTANG TOOLS */
        .tools { display: flex; gap: 15px; margin-top: 15px; }
        .btn-save {
            padding: 12px 30px;
            background: transparent;
            border: 2px solid var(--n-blue);
            color: var(--n-blue);
            cursor: pointer;
            font-weight: bold;
            border-radius: 10px;
            transition: 0.3s;
        }
        .btn-save:hover { background: var(--n-blue); color: #000; box-shadow: 0 0 20px var(--n-blue); }

        /* 10. MEDIA QUERIES (FIX UNTUK TELEFON) */
        @media screen and (max-width: 768px) {
            .slide { padding: 10px 40px; }
            .nav-btn { width: 40px; height: 70px; font-size: 1.2rem; }
            .header-panel h1 { font-size: 1rem; }
            
            .org-row { grid-template-columns: 1fr; text-align: center; }
            .ajk-grid { grid-template-columns: 1fr 1fr; } /* 2 kolum di mobile */
            .duty-wrapper { grid-template-columns: 1fr; } /* Menegak di mobile */
            
            .digital-clock { top: 10px; right: 60px; font-size: 0.8rem; }
        }

        /* Kod Warna Subjek (DIPERBAIKI) */
        .c-BM { background: rgba(255,0,0,0.3) !important; border-color: red !important; }
        .c-BI { background: rgba(0,81,255,0.3) !important; border-color: #0051ff !important; }
        .c-MT { background: rgba(255,242,0,0.2) !important; border-color: #fff200 !important; }
        .c-SN { background: rgba(0,255,30,0.2) !important; border-color: #00ff1e !important; }
        .c-PAI { background: rgba(0,234,255,0.2) !important; border-color: #00eaff !important; }
        .c-PM { background: rgba(255,0,234,0.2) !important; border-color: #ff00ea !important; }
        .c-SJ, .color-SEJ { background: rgba(255,145,0,0.3) !important; border-color: #ff9100 !important; }
        .c-PJ, .color-PK, .color-PJK { background: rgba(149,255,0,0.2) !important; border-color: #95ff00 !important; }
        .c-PER { background: rgba(150,150,150,0.4) !important; border-color: #fff !important; }
        .c-BA { background: rgba(162,0,255,0.3) !important; border-color: #a200ff !important; } /* Ungu */
        .c-TAS { background: rgba(0,255,170,0.25) !important; border-color: #00ffaa !important; } /* Hijau Mint */
        .c-MZ { background: rgba(255,217,0,0.25) !important; border-color: #ffd900 !important; } /* Emas */
        .c-PSV { background: rgba(255,0,115,0.25) !important; border-color: #ff0073 !important; } /* Pink */
        .c-RBT { background: rgba(0,157,255,0.25) !important; border-color: #009dff !important; } /* Biru */
        .c-PIU { background: rgba(0,255,100,0.3) !important; border-color: #00ff64 !important; } /* Hijau Terang */
        .c-PIQ { background: rgba(0,200,150,0.3) !important; border-color: #00c896 !important; } /* Hijau Turquoise */
    </style>
</head>
<body>

    <div class="digital-clock" id="txtClock">00:00:00</div>

    <button class="nav-btn btn-prev" onclick="moveSlide(-1)">‚ùÆ</button>
    <button class="nav-btn btn-next" onclick="moveSlide(1)">‚ùØ</button>

    <div class="viewport" id="vPort">
        
        <div class="slide">
            <div class="header-panel"><h1>STRUKTUR ORGANISASI KELAS</h1></div>
            <div class="main-container">
                <div class="org-wrapper">
                    <div class="org-row">
                        <div class="org-label">GURU KELAS</div>
                        <div class="input-group">
                            <input type="text" class="st-in" placeholder="GURU 1">
                            <input type="text" class="st-in" placeholder="GURU 2">
                        </div>
                    </div>
                    <div class="org-row">
                        <div class="org-label">KETUA & PENOLONG</div>
                        <div class="input-group">
                            <input type="text" class="st-in" placeholder="KETUA">
                            <input type="text" class="st-in" placeholder="PENOLONG">
                        </div>
                    </div>
                    <div class="org-row">
                        <div class="org-label">SETIAUSAHA & BENDAHARI</div>
                        <div class="input-group">
                            <input type="text" class="st-in" placeholder="SETIAUSAHA">
                            <input type="text" class="st-in" placeholder="BENDAHARI">
                        </div>
                    </div>
                    <div class="org-row" style="display: block; text-align: center;">
                        <div class="org-label" style="margin-bottom: 10px;">AJK KEBERSIHAN / KECERIAAN / DISIPLIN</div>
                        <div class="ajk-grid">
                            <input type="text" class="st-in" placeholder="AJK 1">
                            <input type="text" class="st-in" placeholder="AJK 2">
                            <input type="text" class="st-in" placeholder="AJK 3">
                            <input type="text" class="st-in" placeholder="AJK 4">
                            <input type="text" class="st-in" placeholder="AJK 5">
                            <input type="text" class="st-in" placeholder="AJK 6">
                        </div>
                    </div>
                </div>
            </div>
            <div class="tools"><button class="btn-save" onclick="pushData()">üíæ SIMPAN DATA</button></div>
        </div>

        <div class="slide">
            <div class="header-panel"><h1>JADUAL WAKTU 6 CEMERLANG</h1></div>
            <div class="main-container">
                <div class="table-scroll">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 80px;">HARI</th>
                                <th>07:10</th><th>07:40</th><th>08:10</th><th>08:40</th><th>09:10</th>
                                <th style="width: 40px;">REHAT</th>
                                <th>10:00</th><th>10:30</th><th>11:00</th><th>11:30</th><th>12:00</th>
                            </tr>
                        </thead>
                        <tbody id="ttBody"></tbody>
                    </table>
                </div>
            </div>
            <div class="tools"><button class="btn-save" onclick="pushData()">üíæ SIMPAN JADUAL</button></div>
        </div>

        <div class="slide">
            <div class="header-panel"><h1>JADUAL BERTUGAS HARIAN</h1></div>
            <div class="main-container">
                <div class="duty-wrapper" id="dutyWrap"></div>
            </div>
            <div class="tools"><button class="btn-save" onclick="pushData()">üíæ SIMPAN BERTUGAS</button></div>
        </div>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // CONFIGURASI FIREBASE
        const firebaseConfig = {
            apiKey: "AIzaSyBtA37bRurRoe7kCTUX_aIQHNv0cjWG09A",
            authDomain: "jadualkelas-896ae.firebaseapp.com",
            databaseURL: "https://jadualkelas-896ae-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "jadualkelas-896ae",
            storageBucket: "jadualkelas-896ae.firebasestorage.app",
            messagingSenderId: "164261211870",
            appId: "1:164261211870:web:03eb60e7276601953c1c4f"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const dbRef = ref(db, 'jadual_v6_pro'); // Versi baru untuk elak data null

        const HARI = ['ISNIN', 'SELASA', 'RABU', 'KHAMIS', 'JUMAAT'];
        const REHAT_TXT = ['R','E','H','A','T'];
        let curSlide = 1;

        // 1. BINA JADUAL & KAD BERTUGAS
        function buildUI() {
            const tt = document.getElementById('ttBody');
            const dw = document.getElementById('dutyWrap');

            HARI.forEach((h, hIdx) => {
                // Bina Baris Jadual
                let row = `<tr><td style="color:var(--n-blue); font-weight:bold; text-align:center;">${h}</td>`;
                for(let sIdx=0; sIdx<11; sIdx++) {
                    if(sIdx === 5) {
                        row += `<td class="rehat-cell">${REHAT_TXT[hIdx]}</td>`;
                    } else {
                        row += `<td class="slot-cell" data-d="${hIdx}" data-s="${sIdx}">
                            <input type="text" class="tt-in-sub tt-in" placeholder="-" oninput="paint(this)">
                            <input type="text" class="tt-in-guru tt-in" placeholder="GURU">
                        </td>`;
                    }
                }
                row += `</tr>`;
                tt.innerHTML += row;

                // Bina Kad Bertugas
                dw.innerHTML += `
                <div class="duty-card">
                    <div class="duty-title">${h}</div>
                    <div class="task-box">
                        <span class="task-label">üßπ MENYAPU</span>
                        <textarea class="dt-in"></textarea>
                    </div>
                    <div class="task-box">
                        <span class="task-label">ü™ë MEJA & KERUSI</span>
                        <textarea class="dt-in"></textarea>
                    </div>
                    <div class="task-box">
                        <span class="task-label">üóëÔ∏è SAMPAH</span>
                        <textarea class="dt-in"></textarea>
                    </div>
                </div>`;
            });
            moveSlide(0); 
        }

        // 2. NAVIGASI
        window.moveSlide = (n) => {
            curSlide = Math.max(0, Math.min(2, curSlide + n));
            document.getElementById('vPort').style.transform = `translateX(-${curSlide * 100}vw)`;
        };

        // 3. WARNA SUBJEK
        window.paint = (el) => {
            const v = el.value.toUpperCase();
            const td = el.closest('td');
            const colors = ['BM', 'BI', 'MT', 'SN'];
            colors.forEach(c => td.classList.remove(`c-${c}`));
            if(colors.includes(v)) td.classList.add(`c-${v}`);
        };

        // 4. MASA & AUTO-HIGHLIGHT
        function startClock() {
            setInterval(() => {
                const now = new Date();
                const h = now.getHours();
                const m = now.getMinutes();
                const currentMin = h * 60 + m;
                const day = now.getDay() - 1; // 0 = Isnin

                document.getElementById('txtClock').innerText = now.toLocaleTimeString('ms-MY', {hour12:false});

                document.querySelectorAll('.slot-cell').forEach(c => c.classList.remove('slot-active'));

                const slotStarts = [430, 460, 490, 520, 550, 600, 630, 660, 690, 720];
                if(day >= 0 && day <= 4) {
                    slotStarts.forEach((s, i) => {
                        if(currentMin >= s && currentMin < s+30) {
                            const vIdx = i >= 5 ? i + 1 : i;
                            const target = document.querySelector(`.slot-cell[data-d="${day}"][data-s="${vIdx}"]`);
                            if(target) target.classList.add('slot-active');
                        }
                    });
                }
            }, 1000);
        }

        // 5. FIREBASE: LOAD DATA
        function loadData() {
            onValue(dbRef, (snap) => {
                const data = snap.val();
                if(!data) return;

                const st = document.querySelectorAll('.st-in');
                const tt = document.querySelectorAll('.tt-in');
                const dt = document.querySelectorAll('.dt-in');

                if(data.st) data.st.forEach((v, i) => { if(st[i]) st[i].value = v; });
                if(data.tt) data.tt.forEach((v, i) => { 
                    if(tt[i]) {
                        tt[i].value = v;
                        if(tt[i].classList.contains('tt-in-sub')) paint(tt[i]);
                    }
                });
                if(data.dt) data.dt.forEach((v, i) => { if(dt[i]) dt[i].value = v; });
            });
        }

        // 6. FIREBASE: SAVE DATA
        window.pushData = () => {
            const code = prompt("KOD PENGESAHAN:");
            if(code !== "jadualwaktu") return alert("KOD SALAH!");

            const dataObj = {
                st: Array.from(document.querySelectorAll('.st-in')).map(i => i.value),
                tt: Array.from(document.querySelectorAll('.tt-in')).map(i => i.value),
                dt: Array.from(document.querySelectorAll('.dt-in')).map(i => i.value)
            };

            set(dbRef, dataObj)
                .then(() => alert("‚úÖ DATA DISIMPAN!"))
                .catch(e => alert("RALAT: " + e.message));
        };

        buildUI();
        startClock();
        loadData();
    </script>
</body>
</html>
