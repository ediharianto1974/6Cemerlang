<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistem Pengurusan Kelas 6C - SKAG PRO</title>
    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-pink: #ff0055;
            --neon-green: #39ff14;
            --neon-yellow: #fff200;
            --glass-bg: rgba(0, 0, 0, 0.85);
            --card-bg: rgba(10, 10, 15, 0.95);
            --active-glow: rgba(57, 255, 20, 0.3);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            text-transform: uppercase;
            font-family: 'Segoe UI', sans-serif;
        }

        body {
            background-color: #050505;
            background-image: radial-gradient(circle at center, #111 0%, #000 100%);
            color: white;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            display: flex;
        }

        /* Navigasi */
        .nav-btn {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid var(--neon-blue);
            color: var(--neon-blue);
            width: 45px;
            height: 80px;
            cursor: pointer;
            z-index: 3000;
            border-radius: 10px;
            font-size: 1.5rem;
            transition: 0.3s;
        }
        .nav-btn:hover { background: var(--neon-blue); color: black; box-shadow: 0 0 20px var(--neon-blue); }
        .nav-left { left: 10px; }
        .nav-right { right: 10px; }

        .viewport {
            display: flex;
            width: 300vw;
            height: 100vh;
            transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .slide {
            width: 100vw;
            height: 100vh;
            padding: 20px 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Header */
        .header-box {
            text-align: center;
            margin-bottom: 15px;
            background: var(--glass-bg);
            padding: 10px 30px;
            border-radius: 12px;
            border: 2px solid var(--neon-blue);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.3);
        }
        .header-box h1 { font-size: 1.2rem; color: var(--neon-blue); letter-spacing: 2px; }

        .content-container {
            width: 100%;
            flex-grow: 1;
            background: var(--card-bg);
            border-radius: 20px;
            border: 1px solid rgba(0, 243, 255, 0.1);
            padding: 20px;
            overflow-y: auto;
            scrollbar-width: none;
        }
        .content-container::-webkit-scrollbar { display: none; }

        /* Slide 1: Struktur (DIPERBAIKI UNTUK TENGAH) */
        .struct-wrapper { max-width: 900px; margin: 0 auto; display: flex; flex-direction: column; gap: 10px; }
        .struct-group { 
            display: grid; 
            grid-template-columns: 160px 1fr; 
            align-items: center; 
            gap: 15px; 
            background: rgba(255, 255, 255, 0.03); 
            padding: 10px 15px; 
            border-radius: 8px; 
            border-left: 4px solid var(--neon-blue);
        }
        .struct-label { color: var(--neon-blue); font-size: 0.7rem; font-weight: 800; }
        
        /* Centering Guru & AJK */
        .guru-box { 
            display: flex; 
            gap: 10px; 
            align-items: center; 
            justify-content: center; /* Tulisan di tengah horizontal */
            width: 100%; 
        }
        .ajk-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr 1fr; 
            gap: 10px; 
            width: 100%;
            place-items: center; /* Kandungan di tengah */
        }

        .input-line { 
            background: rgba(0,0,0,0.5) !important; 
            border: 1px solid rgba(0,243,255,0.3) !important; 
            border-radius: 5px; 
            color: white !important; 
            padding: 8px; 
            font-size: 0.85rem; 
            width: 100%; 
            outline: none; 
            text-align: center; /* Tulisan yang ditaip di tengah */
        }

        /* Slide 2: Jadual (Responsive Scroll) */
        .table-wrapper { width: 100%; overflow-x: auto; }
        table { width: 100%; border-collapse: separate; border-spacing: 3px; table-layout: fixed; min-width: 900px; }
        th { background: rgba(0, 243, 255, 0.1); color: var(--neon-blue); font-size: 0.65rem; padding: 8px; border: 1px solid var(--neon-blue); }
        td { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.05); height: 60px; }
        
        .active-period { 
            border: 2px solid var(--neon-green) !important; 
            background: var(--active-glow) !important;
            animation: pulse-glow 1.5s infinite;
        }

        .sub-in { font-size: 0.85rem; color: var(--neon-green); font-weight: 900; background: transparent; border: none; text-align: center; width: 100%; outline: none; }
        .teach-in { font-size: 0.55rem; opacity: 0.7; background: transparent; border: none; text-align: center; color: white; width: 100%; outline: none; }
        .rehat-col { background: rgba(255, 0, 85, 0.15) !important; color: var(--neon-pink); font-weight: 900; text-align: center; }

        /* Slide 3: Bertugas */
        .duty-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
        .duty-card { background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(0, 243, 255, 0.1); border-radius: 12px; padding: 12px; }
        .duty-day-title { color: var(--neon-blue); font-weight: 900; text-align: center; margin-bottom: 10px; border-bottom: 1px solid var(--neon-blue); font-size: 0.9rem; }
        .task-label { font-size: 0.7rem; color: var(--neon-yellow); font-weight: bold; display: block; margin-bottom: 4px; }
        .dt-in { background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.1); color: white; border-radius: 4px; padding: 5px; font-size: 0.75rem; width: 100%; text-align: center; resize: none; outline: none; }

        /* Mobile Fixes (Media Queries) */
        @media screen and (max-width: 768px) {
            .slide { padding: 15px 40px; }
            .nav-btn { width: 35px; height: 60px; font-size: 1.2rem; }
            .header-box h1 { font-size: 1rem; }
            
            .struct-group { grid-template-columns: 1fr; text-align: center; }
            .ajk-grid { grid-template-columns: 1fr; }
            .duty-grid { grid-template-columns: 1fr; } /* Bertugas jadi menegak di mobile */
            
            .content-container { padding: 10px; }
        }

        /* Kod Warna Subjek */
        .color-BM { background: rgba(255,0,0,0.2) !important; }
        .color-BI { background: rgba(0,81,255,0.2) !important; }
        .color-MT { background: rgba(255,242,0,0.15) !important; }
        .color-SN { background: rgba(0,255,30,0.15) !important; }

        .btn-row { display: flex; gap: 10px; margin-top: 10px; }
        .btn { padding: 8px 20px; background: transparent; border: 1px solid var(--neon-blue); color: var(--neon-blue); cursor: pointer; border-radius: 8px; font-size: 0.8rem; font-weight: bold; }
        .btn:hover { background: var(--neon-blue); color: black; }
        
        .clock { position: fixed; top: 10px; right: 10px; color: var(--neon-blue); font-weight: 900; font-size: 1rem; background: rgba(0,0,0,0.7); padding: 5px 12px; border-radius: 8px; border: 1px solid var(--neon-blue); z-index: 2000; }
        
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 5px var(--neon-green); }
            50% { box-shadow: 0 0 20px var(--neon-green); }
            100% { box-shadow: 0 0 5px var(--neon-green); }
        }
    </style>
</head>
<body>

    <div class="clock" id="liveClock">00:00:00</div>

    <button class="nav-btn nav-left" onclick="changeSlide(-1)">‚ùÆ</button>
    <button class="nav-btn nav-right" onclick="changeSlide(1)">‚ùØ</button>

    <div class="viewport" id="mainViewport">
        
        <div class="slide">
            <div class="header-box"><h1>STRUKTUR ORGANISASI KELAS 6C</h1></div>
            <div class="content-container">
                <div class="struct-wrapper">
                    <div class="struct-group">
                        <label class="struct-label">GURU KELAS</label>
                        <div class="guru-box">
                            <input type="text" class="input-line st-in" placeholder="GURU 1">
                            <input type="text" class="input-line st-in" placeholder="GURU 2">
                        </div>
                    </div>
                    <div class="struct-group">
                        <label class="struct-label">KETUA & PENOLONG</label>
                        <div class="guru-box">
                            <input type="text" class="input-line st-in" placeholder="KETUA">
                            <input type="text" class="input-line st-in" placeholder="PENOLONG">
                        </div>
                    </div>
                    <div class="struct-group">
                        <label class="struct-label">SETIAUSAHA & BENDAHARI</label>
                        <div class="guru-box">
                            <input type="text" class="input-line st-in" placeholder="SETIAUSAHA">
                            <input type="text" class="input-line st-in" placeholder="BENDAHARI">
                        </div>
                    </div>
                    <div class="struct-group" style="display: block; text-align: center;">
                        <label class="struct-label" style="margin-bottom: 10px; display: block;">AJK KEBERSIHAN / KECERIAAN / KESELAMATAN</label>
                        <div class="ajk-grid">
                            <input type="text" class="input-line st-in" placeholder="AJK 1">
                            <input type="text" class="input-line st-in" placeholder="AJK 2">
                            <input type="text" class="input-line st-in" placeholder="AJK 3">
                        </div>
                    </div>
                </div>
            </div>
            <div class="btn-row"><button class="btn" onclick="saveToFirebase()">üíæ SIMPAN DATA</button></div>
        </div>

        <div class="slide">
            <div class="header-box"><h1>JADUAL WAKTU 6 CEMERLANG</h1></div>
            <div class="content-container">
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 80px;">HARI</th>
                                <th>07:10</th><th>07:40</th><th>08:10</th><th>08:40</th><th>09:10</th>
                                <th style="width: 40px;">REHAT</th>
                                <th>10:00</th><th>10:30</th><th>11:00</th><th>11:30</th><th>12:00</th>
                            </tr>
                        </thead>
                        <tbody id="ttBody"></tbody>
                    </table>
                </div>
            </div>
            <div class="btn-row"><button class="btn" onclick="saveToFirebase()">üíæ SIMPAN JADUAL</button></div>
        </div>

        <div class="slide">
            <div class="header-box"><h1>JADUAL BERTUGAS HARIAN</h1></div>
            <div class="content-container">
                <div class="duty-grid" id="dutyContainer"></div>
            </div>
            <div class="btn-row"><button class="btn" onclick="saveToFirebase()">üíæ SIMPAN BERTUGAS</button></div>
        </div>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBtA37bRurRoe7kCTUX_aIQHNv0cjWG09A",
            authDomain: "jadualkelas-896ae.firebaseapp.com",
            databaseURL: "https://jadualkelas-896ae-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "jadualkelas-896ae",
            storageBucket: "jadualkelas-896ae.firebasestorage.app",
            messagingSenderId: "164261211870",
            appId: "1:164261211870:web:03eb60e7276601953c1c4f"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const dbRef = ref(db, 'jadual_6c');

        const hariArr = ['ISNIN', 'SELASA', 'RABU', 'KHAMIS', 'JUMAAT'];
        const subjekList = ['BM','BI','MT','SN','PAI','PM','SJ','SEJ','PJ','PK','PJK','PSV','MZ','RBT','BA','TAS'];
        let activeSlide = 1;

        window.changeSlide = (n) => {
            activeSlide = Math.max(0, Math.min(2, activeSlide + n));
            document.getElementById('mainViewport').style.transform = `translateX(-${activeSlide * 100}vw)`;
        };

        function init() {
            const tt = document.getElementById('ttBody');
            const dc = document.getElementById('dutyContainer');

            hariArr.forEach((h, i) => {
                let rTT = `<tr><td style="color:var(--neon-blue); font-weight:900; text-align:center; font-size:0.7rem;">${h}</td>`;
                for(let j=0; j<11; j++) {
                    if(j === 5) {
                        rTT += `<td class="rehat-col">R</td>`;
                    } else {
                        rTT += `<td class="slot-cell" data-day="${i}" data-slot="${j}">
                            <input type="text" class="sub-in tt-in" oninput="applyColor(this)" placeholder="-">
                            <input type="text" class="teach-in tt-in" placeholder="GURU">
                        </td>`;
                    }
                }
                rTT += `</tr>`;
                tt.innerHTML += rTT;

                dc.innerHTML += `
                    <div class="duty-card">
                        <div class="duty-day-title">${h}</div>
                        <label class="task-label">üßπ MENYAPU</label>
                        <textarea class="dt-in" placeholder="NAMA"></textarea>
                        <label class="task-label">ü™ë MEJA</label>
                        <textarea class="dt-in" placeholder="NAMA"></textarea>
                        <label class="task-label">üóëÔ∏è SAMPAH</label>
                        <textarea class="dt-in" placeholder="NAMA"></textarea>
                    </div>`;
            });

            onValue(dbRef, (snap) => {
                const d = snap.val();
                if (!d) return;
                const stIn = document.querySelectorAll('.st-in');
                d.st?.forEach((v, i) => { if(stIn[i]) stIn[i].value = v; });
                const ttIn = document.querySelectorAll('.tt-in');
                d.tt?.forEach((v, i) => { 
                    if(ttIn[i]) {
                        ttIn[i].value = v;
                        if(ttIn[i].classList.contains('sub-in')) applyColor(ttIn[i]);
                    }
                });
                const dtIn = document.querySelectorAll('.dt-in');
                d.dt?.forEach((v, i) => { if(dtIn[i]) dtIn[i].value = v; });
            });

            setInterval(runClock, 1000);
        }

        window.applyColor = (el) => {
            const val = el.value.trim().toUpperCase();
            const td = el.closest('td');
            subjekList.forEach(s => td.classList.remove(`color-${s}`));
            if (subjekList.includes(val)) td.classList.add(`color-${val}`);
        };

        function runClock() {
            const now = new Date();
            document.getElementById('liveClock').innerText = now.toLocaleTimeString('ms-MY', {hour12:false});
            
            const mins = now.getHours() * 60 + now.getMinutes();
            const day = now.getDay() - 1;
            const slotStarts = [430, 460, 490, 520, 550, 600, 630, 660, 690, 720];

            document.querySelectorAll('.slot-cell').forEach(c => c.classList.remove('active-period'));
            if(day >= 0 && day <= 4) {
                slotStarts.forEach((s, idx) => {
                    if(mins >= s && mins < s+30) {
                        const vSlot = idx >= 5 ? idx + 1 : idx;
                        const cell = document.querySelector(`.slot-cell[data-day="${day}"][data-slot="${vSlot}"]`);
                        if(cell) cell.classList.add('active-period');
                    }
                });
            }
        }

        window.saveToFirebase = () => {
            if(prompt("KOD AKSES:") !== "jadualwaktu") return alert("KOD SALAH!");
            const data = {
                st: Array.from(document.querySelectorAll('.st-in')).map(i => i.value),
                tt: Array.from(document.querySelectorAll('.tt-in')).map(i => i.value),
                dt: Array.from(document.querySelectorAll('.dt-in')).map(i => i.value)
            };
            set(dbRef, data).then(() => alert("‚úÖ BERJAYA!")).catch(e => alert("ERROR: " + e.message));
        };

        init();
        changeSlide(0);
    </script>
</body>
</html>
